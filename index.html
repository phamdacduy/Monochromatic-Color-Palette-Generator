<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Enhanced Color Palette Generator</title>
    <style>
      * {
        box-sizing: border-box;
      }

      body {
        padding: 1rem;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto,
          sans-serif;
        background-color: #f9fafb;
        color: #111827;
        line-height: 1.6;
        margin: 0;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
      }

      .section {
        margin-top: 2rem;
        background: white;
        padding: 1.5rem;
        border-radius: 0.75rem;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      }

      h1 {
        font-size: 1.875rem;
        font-weight: 700;
        margin-bottom: 2rem;
        text-align: center;
        color: #1f2937;
      }

      h2 {
        font-size: 1.25rem;
        font-weight: 600;
        margin-bottom: 0.5rem;
        color: #374151;
      }

      .desc {
        font-size: 0.875rem;
        color: #6b7280;
        margin-bottom: 1.5rem;
      }

      .input-group {
        display: flex;
        align-items: center;
        gap: 1rem;
        flex-wrap: wrap;
      }

      .input-color {
        appearance: none;
        height: 3rem;
        width: 4rem;
        border: 2px solid #e5e7eb;
        border-radius: 0.5rem;
        cursor: pointer;
      }

      .input-color::-webkit-color-swatch-wrapper {
        padding: 0;
      }

      .input-color::-webkit-color-swatch {
        border: none;
        border-radius: 0.375rem;
      }

      .button {
        background-color: #3b82f6;
        color: white;
        padding: 0.75rem 1.5rem;
        border: none;
        border-radius: 0.5rem;
        cursor: pointer;
        font-weight: 500;
        transition: background-color 0.2s;
      }

      .button:hover {
        background-color: #2563eb;
      }

      .palette-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 1rem;
        margin-top: 1rem;
      }

      .palette-row {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 1rem;
        margin-bottom: 1rem;
      }

      .color-box {
        display: flex;
        border-radius: 0.75rem;
        overflow: hidden;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        transition: transform 0.2s, box-shadow 0.2s;
        cursor: pointer;
        min-height: 120px;
      }

      .color-box:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 12px rgba(0, 0, 0, 0.15);
      }

      .color-swatch {
        width: 80px;
        min-width: 80px;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        font-size: 0.7rem;
        font-weight: 600;
        text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
        position: relative;
      }

      .color-info {
        flex: 1;
        padding: 1rem;
        background: white;
        display: flex;
        flex-direction: column;
        justify-content: center;
      }

      .color-name {
        font-size: 0.95rem;
        font-weight: 600;
        color: #1f2937;
        margin-bottom: 0.25rem;
      }

      .color-codes {
        font-family: monospace;
        font-size: 0.75rem;
        color: #6b7280;
        margin-bottom: 0.5rem;
      }

      .color-description {
        font-size: 0.8rem;
        color: #374151;
        line-height: 1.4;
      }

      .color-usage {
        font-size: 0.75rem;
        color: #6b7280;
        margin-top: 0.25rem;
        font-style: italic;
      }

      .grayscale-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 1rem;
        margin-top: 1rem;
      }

      .rgb-input {
        padding: 0.75rem;
        border: 2px solid #e5e7eb;
        border-radius: 0.5rem;
        font-family: monospace;
        font-size: 0.875rem;
        min-width: 200px;
        transition: border-color 0.2s;
      }

      .rgb-input:focus {
        outline: none;
        border-color: #3b82f6;
      }

      .export-buttons {
        display: flex;
        gap: 0.5rem;
        margin-top: 1rem;
        flex-wrap: wrap;
      }

      .export-button {
        background-color: #10b981;
        color: white;
        padding: 0.5rem 1rem;
        border: none;
        border-radius: 0.375rem;
        cursor: pointer;
        font-size: 0.875rem;
        font-weight: 500;
        transition: background-color 0.2s;
      }

      .export-button:hover {
        background-color: #059669;
      }

      .export-button.svg {
        background-color: #8b5cf6;
      }

      .export-button.svg:hover {
        background-color: #7c3aed;
      }

      #finalPaletteContainer {
        width: 100%;
        margin-top: 1rem;
        display: flex;
        justify-content: center;
      }

      .palette-section {
        margin-bottom: 2rem;
      }

      .section-title {
        font-size: 1.1rem;
        font-weight: 600;
        margin-bottom: 0.75rem;
        color: #374151;
        border-bottom: 2px solid #e5e7eb;
        padding-bottom: 0.5rem;
      }

      .copy-notification {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: rgba(0, 0, 0, 0.8);
        color: white;
        padding: 0.25rem 0.5rem;
        border-radius: 0.25rem;
        font-size: 0.7rem;
        pointer-events: none;
        opacity: 0;
        transition: opacity 0.3s;
      }

      .copy-notification.show {
        opacity: 1;
      }

      @media (max-width: 768px) {
        body {
          padding: 0.5rem;
        }

        .section {
          padding: 1rem;
        }

        h1 {
          font-size: 1.5rem;
        }

        .palette-grid {
          grid-template-columns: 1fr;
        }

        .palette-row {
          grid-template-columns: 1fr;
        }

        .color-box {
          min-height: 100px;
        }
        
        .color-swatch {
          width: 60px;
          min-width: 60px;
        }

        .color-info {
          padding: 0.75rem;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>Enhanced Color Palette Generator</h1>

      <div class="section">
        <h2>Step 1: Choose a Primary Color</h2>
        <p class="desc">
          Used for buttons, focused inputs, checkboxes, and UI highlights.
        </p>
        <div class="input-group">
          <input
            type="color"
            class="input-color"
            id="primaryColor"
            value="#3a86ff"
          />
          <input
            type="text"
            class="rgb-input"
            id="rgbInput"
            placeholder="RGB or HEX (e.g., 58, 134, 255 or #3a86ff)"
          />
          <button class="button" onclick="generatePalette()">
            Generate Palette
          </button>
        </div>
      </div>

      <div class="section">
        <h2>Step 2: Primary Color</h2>
        <p class="desc">Your selected primary color with naming convention.</p>
        <div class="palette-grid" id="primaryPalette"></div>
      </div>

      <div class="section">
        <h2>Step 3: Notification Colors</h2>
        <p class="desc">
          Standard colors for system feedback with descriptions and usage.
        </p>
        <div class="palette-grid" id="notificationsPalette"></div>
      </div>

      <div class="section">
        <h2>Step 4: Primary Tints & Shades</h2>
        <p class="desc">
          Complete range of your primary color from light to dark with semantic
          names.
        </p>
        <div id="primaryVariants">
          <div class="palette-section">
            <div class="section-title">Primary Color Scale</div>
            <div class="palette-row" id="primaryScale"></div>
          </div>
        </div>
      </div>

      <div class="section">
        <h2>Step 5: Success Color Scale</h2>
        <p class="desc">
          Complete success color range for positive states and confirmations.
        </p>
        <div class="palette-section">
          <div class="palette-row" id="successScale"></div>
        </div>
      </div>

      <div class="section">
        <h2>Step 6: Warning Color Scale</h2>
        <p class="desc">
          Complete warning color range for caution states and pending actions.
        </p>
        <div class="palette-section">
          <div class="palette-row" id="warningScale"></div>
        </div>
      </div>

      <div class="section">
        <h2>Step 7: Error Color Scale</h2>
        <p class="desc">
          Complete error color range for danger states and destructive actions.
        </p>
        <div class="palette-section">
          <div class="palette-row" id="errorScale"></div>
        </div>
      </div>

      <div class="section">
        <h2>Step 8: Grayscale</h2>
        <p class="desc">
          Neutral tones for backgrounds, text, and UI elements with semantic
          names.
        </p>
        <div class="grayscale-grid" id="grayscalePalette"></div>
      </div>

      <div class="section">
        <h2>Combined Palette Export</h2>
        <p class="desc">
          Export your complete color system as PNG or SVG for design tools.
        </p>
        <div id="finalPaletteContainer"></div>
        <div class="export-buttons">
          <button class="export-button" onclick="exportAsPNG()">
            Download PNG
          </button>
          <button class="export-button svg" onclick="exportAsSVG()">
            Download SVG
          </button>
        </div>
      </div>
    </div>

    <script>
      // Color naming and description data
      const colorData = {
        primary: {
          100: {
            name: 'Primary-100',
            description: 'Light backgrounds, hover states',
            usage: 'Card hover, light sections',
          },
          200: {
            name: 'Primary-200',
            description: 'Selected item backgrounds',
            usage: 'Selected rows, light buttons',
          },
          300: {
            name: 'Primary-300',
            description: 'Focus borders, dividers',
            usage: 'Input focus, tabs, steps',
          },
          400: {
            name: 'Primary-400',
            description: 'Secondary buttons, icons',
            usage: 'Icon buttons, form icons',
          },
          500: {
            name: 'Primary-500',
            description: 'Main brand color, primary actions',
            usage: 'CTA buttons, links, focus rings',
          },
          600: {
            name: 'Primary-600',
            description: 'Button hover states',
            usage: 'Primary button hover',
          },
          700: {
            name: 'Primary-700',
            description: 'Button pressed states',
            usage: 'Primary button pressed',
          },
          800: {
            name: 'Primary-800',
            description: 'High contrast text, headers',
            usage: 'Section headings, labels',
          },
          900: {
            name: 'Primary-900',
            description: 'Main headings, maximum emphasis',
            usage: 'Page titles, hero text',
          },
        },
        success: {
          100: {
            name: 'Success-100',
            description: 'Light success backgrounds',
            usage: 'Success cards, notifications',
          },
          200: {
            name: 'Success-200',
            description: 'Success notification backgrounds',
            usage: 'Success alerts, badges',
          },
          300: {
            name: 'Success-300',
            description: 'Success borders',
            usage: 'Success input borders',
          },
          400: {
            name: 'Success-400',
            description: 'Success icons, secondary buttons',
            usage: 'Success icons, light buttons',
          },
          500: {
            name: 'Success-500',
            description: 'Main success color',
            usage: 'Success buttons, confirmations',
          },
          600: {
            name: 'Success-600',
            description: 'Success button hover',
            usage: 'Success button hover',
          },
          700: {
            name: 'Success-700',
            description: 'Success button pressed',
            usage: 'Success button pressed',
          },
          800: {
            name: 'Success-800',
            description: 'Success headings',
            usage: 'Success text, headings',
          },
          900: {
            name: 'Success-900',
            description: 'High contrast success text',
            usage: 'Strong success emphasis',
          },
        },
        warning: {
          100: {
            name: 'Warning-100',
            description: 'Light warning backgrounds',
            usage: 'Warning cards, notifications',
          },
          200: {
            name: 'Warning-200',
            description: 'Warning notification backgrounds',
            usage: 'Warning alerts, badges',
          },
          300: {
            name: 'Warning-300',
            description: 'Warning borders',
            usage: 'Warning input borders',
          },
          400: {
            name: 'Warning-400',
            description: 'Warning icons, secondary buttons',
            usage: 'Warning icons, light buttons',
          },
          500: {
            name: 'Warning-500',
            description: 'Main warning color',
            usage: 'Warning buttons, caution states',
          },
          600: {
            name: 'Warning-600',
            description: 'Warning button hover',
            usage: 'Warning button hover',
          },
          700: {
            name: 'Warning-700',
            description: 'Warning button pressed',
            usage: 'Warning button pressed',
          },
          800: {
            name: 'Warning-800',
            description: 'Warning headings',
            usage: 'Warning text, headings',
          },
          900: {
            name: 'Warning-900',
            description: 'High contrast warning text',
            usage: 'Strong warning emphasis',
          },
        },
        error: {
          100: {
            name: 'Error-100',
            description: 'Light error backgrounds',
            usage: 'Error cards, notifications',
          },
          200: {
            name: 'Error-200',
            description: 'Error notification backgrounds',
            usage: 'Error alerts, badges',
          },
          300: {
            name: 'Error-300',
            description: 'Error borders, validation',
            usage: 'Error input borders, validation',
          },
          400: {
            name: 'Error-400',
            description: 'Error icons, secondary buttons',
            usage: 'Error icons, light buttons',
          },
          500: {
            name: 'Error-500',
            description: 'Main error color',
            usage: 'Delete buttons, error alerts',
          },
          600: {
            name: 'Error-600',
            description: 'Error button hover',
            usage: 'Error button hover',
          },
          700: {
            name: 'Error-700',
            description: 'Error button pressed',
            usage: 'Destructive actions',
          },
          800: {
            name: 'Error-800',
            description: 'Error headings',
            usage: 'Error text, headings',
          },
          900: {
            name: 'Error-900',
            description: 'High contrast error text',
            usage: 'Strong error emphasis',
          },
        },
        gray: {
          100: {
            name: 'Gray-100',
            description: 'Page backgrounds, cards',
            usage: 'Main background, card containers',
          },
          200: {
            name: 'Gray-200',
            description: 'Dividers, light borders',
            usage: 'HR elements, table borders',
          },
          300: {
            name: 'Gray-300',
            description: 'Input borders, placeholder text',
            usage: 'Form borders, placeholders',
          },
          400: {
            name: 'Gray-400',
            description: 'Icons, secondary text',
            usage: 'UI icons, helper text',
          },
          500: {
            name: 'Gray-500',
            description: 'Body text, standard content',
            usage: 'Paragraph text, descriptions',
          },
          600: {
            name: 'Gray-600',
            description: 'Headings, important text',
            usage: 'Section headings, labels',
          },
          700: {
            name: 'Gray-700',
            description: 'Main headings, navigation',
            usage: 'Page titles, navigation',
          },
          800: {
            name: 'Gray-800',
            description: 'Primary text, high contrast',
            usage: 'Main content text',
          },
          900: {
            name: 'Gray-900',
            description: 'Maximum contrast text',
            usage: 'Hero titles, critical alerts',
          },
          1000: {
            name: 'Gray-1000',
            description: 'Pure black text',
            usage: 'Fine print, maximum contrast',
          },
        },
      };

      // Global variable to store current palette data
      let currentPalette = {};

      function hexToRgb(hex) {
        const bigint = parseInt(hex.slice(1), 16);
        const r = (bigint >> 16) & 255;
        const g = (bigint >> 8) & 255;
        const b = bigint & 255;
        return { r, g, b };
      }

      function hslToHex(h, s, l) {
        l /= 100;
        const a = (s * Math.min(l, 1 - l)) / 100;
        const f = (n) => {
          const k = (n + h / 30) % 12;
          const color = l - a * Math.max(Math.min(k - 3, 9 - k, 1), -1);
          return Math.round(255 * color)
            .toString(16)
            .padStart(2, '0');
        };
        return `#${f(0)}${f(8)}${f(4)}`;
      }

      function hexToHSL(H) {
        let r = 0,
          g = 0,
          b = 0;
        if (H.length === 4) {
          r = '0x' + H[1] + H[1];
          g = '0x' + H[2] + H[2];
          b = '0x' + H[3] + H[3];
        } else if (H.length === 7) {
          r = '0x' + H[1] + H[2];
          g = '0x' + H[3] + H[4];
          b = '0x' + H[5] + H[6];
        }
        r /= 255;
        g /= 255;
        b /= 255;
        const cmin = Math.min(r, g, b),
          cmax = Math.max(r, g, b),
          delta = cmax - cmin;
        let h = 0,
          s = 0,
          l = 0;
        if (delta === 0) h = 0;
        else if (cmax === r) h = ((g - b) / delta) % 6;
        else if (cmax === g) h = (b - r) / delta + 2;
        else h = (r - g) / delta + 4;
        h = Math.round(h * 60);
        if (h < 0) h += 360;
        l = (cmax + cmin) / 2;
        s = delta === 0 ? 0 : delta / (1 - Math.abs(2 * l - 1));
        s = +(s * 100).toFixed(1);
        l = +(l * 100).toFixed(1);
        return { h, s, l };
      }

      function parseColorInput(input) {
        input = input.trim();
        if (input.match(/^#?[0-9A-Fa-f]{6}$/)) {
          return input.startsWith('#') ? input : '#' + input;
        }
        const rgbMatch = input.match(/(\d+),?\s*(\d+),?\s*(\d+)/);
        if (rgbMatch) {
          const r = parseInt(rgbMatch[1]);
          const g = parseInt(rgbMatch[2]);
          const b = parseInt(rgbMatch[3]);
          if (r >= 0 && r <= 255 && g >= 0 && g <= 255 && b >= 0 && b <= 255) {
            return (
              '#' + ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1)
            );
          }
        }
        return null;
      }

      function getContrastColor(hex) {
        const { r, g, b } = hexToRgb(hex);
        const luminance = (0.299 * r + 0.587 * g + 0.114 * b) / 255;
        return luminance > 0.5 ? '#000000' : '#ffffff';
      }

      function createEnhancedColorBox(color, colorName, description, usage) {
        const { r, g, b } = hexToRgb(color);
        const rgb = `${r}, ${g}, ${b}`;
        const div = document.createElement('div');
        div.className = 'color-box';

        const contrastColor = getContrastColor(color);

        div.innerHTML = `
          <div class="color-swatch" style="background-color: ${color}; color: ${contrastColor};">
            <div>${color.toUpperCase()}</div>
            <div class="copy-notification">Copied!</div>
          </div>
          <div class="color-info">
            <div class="color-name">${colorName}</div>
            <div class="color-codes">HEX: ${color} â€¢ RGB: ${rgb}</div>
            <div class="color-description">${description}</div>
            <div class="color-usage">${usage}</div>
          </div>
        `;

        div.onclick = () => {
          navigator.clipboard.writeText(color);
          const notification = div.querySelector('.copy-notification');
          notification.classList.add('show');
          setTimeout(() => {
            notification.classList.remove('show');
          }, 1000);
        };

        return div;
      }

      function generateColorScale(baseColor, colorType) {
        const { h, s, l } = hexToHSL(baseColor);
        const scale = {};

        // Generate tints (100-400)
        for (let i = 1; i <= 4; i++) {
          const tintL = Math.min(95, l + (i * (95 - l)) / 5);
          const tintS = Math.max(20, s - i * 10); // Reduce saturation for lighter tints
          scale[100 * i] = hslToHex(h, tintS, tintL);
        }

        // Base color (500)
        scale[500] = baseColor;

        // Generate shades (600-900)
        for (let i = 1; i <= 4; i++) {
          const shadeL = Math.max(10, l - (i * (l - 10)) / 5);
          const shadeS = Math.min(100, s + i * 5); // Increase saturation for darker shades
          scale[600 + (i - 1) * 100] = hslToHex(h, shadeS, shadeL);
        }

        return scale;
      }

      function generateGrayscale(primaryHex) {
        const { h } = hexToHSL(primaryHex);
        const scale = {};
        const lightnesses = [95, 85, 70, 55, 45, 35, 25, 15, 10, 5];

        lightnesses.forEach((lightness, index) => {
          const scaleValue = (index + 1) * 100;
          if (scaleValue <= 1000) {
            scale[scaleValue] = hslToHex(h, 15, lightness);
          }
        });

        return scale;
      }

      function displayColorScale(containerId, colors, colorType) {
        const container = document.getElementById(containerId);
        container.innerHTML = '';

        Object.entries(colors).forEach(([scale, color]) => {
          const colorInfo = colorData[colorType][scale];
          if (colorInfo) {
            const colorBox = createEnhancedColorBox(
              color,
              colorInfo.name,
              colorInfo.description,
              colorInfo.usage
            );
            container.appendChild(colorBox);
          }
        });
      }

      function generatePalette() {
        const primary = document.getElementById('primaryColor').value;

        // Generate color scales
        const primaryScale = generateColorScale(primary, 'primary');
        const successScale = generateColorScale('#10b981', 'success');
        const warningScale = generateColorScale('#f59e0b', 'warning');
        const errorScale = generateColorScale('#ef4444', 'error');
        const grayscaleScale = generateGrayscale(primary);

        // Display primary color
        const primaryContainer = document.getElementById('primaryPalette');
        primaryContainer.innerHTML = '';
        const primaryBox = createEnhancedColorBox(
          primary,
          'Primary-500',
          'Main brand color, primary actions',
          'CTA buttons, links, focus rings, brand elements'
        );
        primaryContainer.appendChild(primaryBox);

        // Display notification colors
        const notificationContainer = document.getElementById(
          'notificationsPalette'
        );
        notificationContainer.innerHTML = '';

        const notifications = [
          {
            color: '#10b981',
            name: 'Success-500',
            desc: 'Success states, confirmations',
            usage: 'Success buttons, positive feedback',
          },
          {
            color: '#f59e0b',
            name: 'Warning-500',
            desc: 'Warning states, caution',
            usage: 'Warning alerts, pending actions',
          },
          {
            color: '#ef4444',
            name: 'Error-500',
            desc: 'Error states, destructive actions',
            usage: 'Delete buttons, error alerts',
          },
        ];

        notifications.forEach((notif) => {
          const box = createEnhancedColorBox(
            notif.color,
            notif.name,
            notif.desc,
            notif.usage
          );
          notificationContainer.appendChild(box);
        });

        // Display color scales
        displayColorScale('primaryScale', primaryScale, 'primary');
        displayColorScale('successScale', successScale, 'success');
        displayColorScale('warningScale', warningScale, 'warning');
        displayColorScale('errorScale', errorScale, 'error');
        displayColorScale('grayscalePalette', grayscaleScale, 'gray');

        // Store palette data
        currentPalette = {
          primary: primaryScale,
          success: successScale,
          warning: warningScale,
          error: errorScale,
          grayscale: grayscaleScale,
        };

        drawFinalPalette(currentPalette);
      }

      function drawFinalPalette(paletteData) {
        const container = document.getElementById('finalPaletteContainer');
        container.innerHTML = '';

        const swatchWidth = 120;
        const swatchHeight = 80;
        const textHeight = 60;
        const rowHeight = swatchHeight + textHeight;

        // Organize colors by rows
        const rows = [
          {
            colors: Object.values(paletteData.primary),
            label: 'Primary Scale',
            type: 'primary',
          },
          {
            colors: Object.values(paletteData.success),
            label: 'Success Scale',
            type: 'success',
          },
          {
            colors: Object.values(paletteData.warning),
            label: 'Warning Scale',
            type: 'warning',
          },
          {
            colors: Object.values(paletteData.error),
            label: 'Error Scale',
            type: 'error',
          },
          {
            colors: Object.values(paletteData.grayscale).slice(0, 5),
            label: 'Grayscale 1-5',
            type: 'gray',
          },
          {
            colors: Object.values(paletteData.grayscale).slice(5),
            label: 'Grayscale 6-10',
            type: 'gray',
          },
        ];

        const maxCols = Math.max(...rows.map((row) => row.colors.length));
        const svgWidth = maxCols * swatchWidth;
        const svgHeight = rows.length * rowHeight;

        const svg = document.createElementNS(
          'http://www.w3.org/2000/svg',
          'svg'
        );
        svg.setAttribute('width', svgWidth);
        svg.setAttribute('height', svgHeight);
        svg.setAttribute('viewBox', `0 0 ${svgWidth} ${svgHeight}`);
        svg.style.maxWidth = '100%';
        svg.style.height = 'auto';
        svg.style.border = '1px solid #e5e7eb';
        svg.style.borderRadius = '0.5rem';
        svg.id = 'finalPaletteSVG';

        // Add white background
        const background = document.createElementNS(
          'http://www.w3.org/2000/svg',
          'rect'
        );
        background.setAttribute('width', svgWidth);
        background.setAttribute('height', svgHeight);
        background.setAttribute('fill', '#ffffff');
        svg.appendChild(background);

        rows.forEach((row, rowIndex) => {
          const y = rowIndex * rowHeight;

          row.colors.forEach((color, colIndex) => {
            const x = colIndex * swatchWidth;

            // Draw color swatch
            const rect = document.createElementNS(
              'http://www.w3.org/2000/svg',
              'rect'
            );
            rect.setAttribute('x', x);
            rect.setAttribute('y', y);
            rect.setAttribute('width', swatchWidth);
            rect.setAttribute('height', swatchHeight);
            rect.setAttribute('fill', color);
            rect.setAttribute('stroke', '#e5e7eb');
            rect.setAttribute('stroke-width', '1');
            svg.appendChild(rect);

            // Get color name based on position and type
            const scales = [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000];
            const scaleValue = scales[colIndex] || 500;
            const colorInfo =
              colorData[row.type] && colorData[row.type][scaleValue]
                ? colorData[row.type][scaleValue]
                : { name: `${row.type}-${scaleValue}`, description: '' };

            // Draw color name
            const nameText = document.createElementNS(
              'http://www.w3.org/2000/svg',
              'text'
            );
            nameText.setAttribute('x', x + swatchWidth / 2);
            nameText.setAttribute('y', y + swatchHeight + 16);
            nameText.setAttribute('text-anchor', 'middle');
            nameText.setAttribute('font-family', 'system-ui, sans-serif');
            nameText.setAttribute('font-size', '12');
            nameText.setAttribute('font-weight', 'bold');
            nameText.setAttribute('fill', '#1f2937');
            nameText.textContent = colorInfo.name;
            svg.appendChild(nameText);

            // Draw hex code
            const hexText = document.createElementNS(
              'http://www.w3.org/2000/svg',
              'text'
            );
            hexText.setAttribute('x', x + swatchWidth / 2);
            hexText.setAttribute('y', y + swatchHeight + 32);
            hexText.setAttribute('text-anchor', 'middle');
            hexText.setAttribute('font-family', 'monospace');
            hexText.setAttribute('font-size', '11');
            hexText.setAttribute('fill', '#6b7280');
            hexText.textContent = color.toUpperCase();
            svg.appendChild(hexText);

            // Draw RGB code
            const { r, g, b } = hexToRgb(color);
            const rgbText = document.createElementNS(
              'http://www.w3.org/2000/svg',
              'text'
            );
            rgbText.setAttribute('x', x + swatchWidth / 2);
            rgbText.setAttribute('y', y + swatchHeight + 48);
            rgbText.setAttribute('text-anchor', 'middle');
            rgbText.setAttribute('font-family', 'monospace');
            rgbText.setAttribute('font-size', '10');
            rgbText.setAttribute('fill', '#9ca3af');
            rgbText.textContent = `rgb(${r}, ${g}, ${b})`;
            svg.appendChild(rgbText);
          });
        });

        container.appendChild(svg);
      }

      function exportAsPNG() {
        const svg = document.getElementById('finalPaletteSVG');
        const svgData = new XMLSerializer().serializeToString(svg);
        const canvas = document.createElement('canvas');
        const ctx = canvas.getContext('2d');
        const img = new Image();

        canvas.width = parseInt(svg.getAttribute('width'));
        canvas.height = parseInt(svg.getAttribute('height'));

        img.onload = function () {
          ctx.fillStyle = '#ffffff';
          ctx.fillRect(0, 0, canvas.width, canvas.height);
          ctx.drawImage(img, 0, 0);

          canvas.toBlob(function (blob) {
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'enhanced-color-palette.png';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
          });
        };

        img.src =
          'data:image/svg+xml;base64,' +
          btoa(unescape(encodeURIComponent(svgData)));
      }

      function exportAsSVG() {
        const svg = document.getElementById('finalPaletteSVG');
        const svgData = new XMLSerializer().serializeToString(svg);
        const blob = new Blob([svgData], { type: 'image/svg+xml' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'enhanced-color-palette.svg';
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
      }

      function updateRGBFromPicker() {
        const colorPicker = document.getElementById('primaryColor');
        const rgbInput = document.getElementById('rgbInput');
        const { r, g, b } = hexToRgb(colorPicker.value);
        rgbInput.value = `${r}, ${g}, ${b}`;
        rgbInput.style.borderColor = '#e5e7eb';
      }

      // Initialize when page loads
      document.addEventListener('DOMContentLoaded', function () {
        const colorPicker = document.getElementById('primaryColor');
        const rgbInput = document.getElementById('rgbInput');

        // Update RGB input when color picker changes
        colorPicker.addEventListener('change', updateRGBFromPicker);

        // Update color picker when RGB input changes
        rgbInput.addEventListener('input', function () {
          const parsed = parseColorInput(this.value);
          if (parsed) {
            colorPicker.value = parsed;
            this.style.borderColor = '#10b981';
          } else if (this.value) {
            this.style.borderColor = '#ef4444';
          } else {
            this.style.borderColor = '#e5e7eb';
          }
        });

        // Generate palette when Enter is pressed in RGB input
        rgbInput.addEventListener('keypress', function (e) {
          if (e.key === 'Enter') {
            generatePalette();
          }
        });

        // Initialize
        updateRGBFromPicker();
        generatePalette();
      });
    </script>
  </body>
</html>
